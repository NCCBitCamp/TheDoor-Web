<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            background-color: black;
            color: white;
        }
        .text_box {
            display: flex;
            justify-content: left;
            align-items: center;
            height: 100px;
            font-size: 1rem;
            margin: 20%;
        }
        .redirect-button {
            display: none; /* 초기에는 버튼을 숨깁니다. */
            margin-top: 20px;
            padding: 10px 20px;
            background-color: white;
            color: black;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
        .scary-image {
            display: none; /* 초기에는 이미지를 숨깁니다. */
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="text_box" data-trigger>
        <span class="text"></span>
    </div>
    <audio id="audio"></audio>
    <button class="redirect-button" onclick="location.href='the_door_main.html'">Go to Main Door</button>
    <img src="bloody_hand.png" class="scary-image" id="scaryImage">

    <script>
        const content = [
            { text: "                 ", audio: "Nar_2_1.mp3" },
            { text: "책상은 순식간에 무너져 당신을 덮친다.", audio: "Nar_2_2.mp3" },
            { text: "끔찍한 죽음, 당신은 책장에 깔려 형체를 알아보기 힘들 정도로 찢겼다.", audio: "Nar_2_3.mp3" },
        ];
        const textElement = document.querySelector(".text");
        const audioElement = document.getElementById("audio");
        const redirectButton = document.querySelector(".redirect-button");
        const scaryImage = document.getElementById("scaryImage");

        let index = 0;
        let charIndex = 0; //문장 길이
        let isDeleting = false; //지울까요? 물어보기

        function typing() {
            if (index < content.length) {
                if (!isDeleting && charIndex < content[index].text.length) {
                    textElement.innerHTML += content[index].text.charAt(charIndex); // 한 글자씩 출력
                    charIndex++; //그 다음 글자 대령
                } else if (isDeleting && charIndex > 0) {
                    textElement.innerHTML = content[index].text.substring(0, charIndex - 1); // 한 글자씩 지워
                    charIndex--; // 그 전 글자 대령
                } else if (!isDeleting && charIndex === content[index].text.length) {
                    playAudio(content[index].audio);
                    if (index === content.length - 1) { // 마지막 텍스트가 끝나면
                        setTimeout(() => {
                            redirectButton.style.display = 'block'; // 버튼을 보여줍니다.
                            scaryImage.style.display = 'block'; // 이미지 표시
                        }, 3000); // 3초 후에 버튼과 이미지를 나타냅니다.
                    }
                    isDeleting = true; // 지울까요?를 true 변환
                    setTimeout(typing, 4000); // 잠시 멈춤 후 지우기 시작
                    return;
                } else if (isDeleting && charIndex === 0) {
                    isDeleting = false; // 이제 그만지워라. 지울가요?를 false 변환
                    index++; // 다음줄로~
                    if (index < content.length) {
                        textElement.innerHTML += '<br>'; // 줄 바꿈 추가
                    }
                }
            } else {
                clearInterval(typingInterval);
            }
            setTimeout(typing, isDeleting ? 10 : 100); // 타이핑 속도와 지우기 속도 설정
        }

        function playAudio(audioSrc) {
            audioElement.src = audioSrc;
            audioElement.play();
        }

        typing(); // 글자 타이핑 시작
    </script>

</body>
</html>
